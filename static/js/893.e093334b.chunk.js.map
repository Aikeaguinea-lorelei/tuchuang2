{"version":3,"file":"static/js/893.e093334b.chunk.js","mappings":"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","sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"sourcesContent":["import React,{ useRef } from 'react'\r\nimport { useStores } from '../stores'\r\nimport { observer,useLocalStore } from 'mobx-react'\r\nimport { InboxOutlined } from '@ant-design/icons';  // 图标\r\nimport { message, Upload, spin } from 'antd';  // spin: 加载中\r\nimport styled from 'styled-components'\r\n\r\nconst { Dragger } = Upload;\r\nconst Result=styled.div`\r\n    margin-top:30px;\r\n    border:1px dashed #ccc;\r\n    padding:20px;\r\n    background-color:#fafafa;\r\n`;\r\nconst H1=styled.h1`\r\n    margin:20px 0;\r\n    text-align:center;\r\n`;\r\nconst Image=styled.img`\r\n    max-width:300px;\r\n`;\r\nconst H2=styled.h2`\r\n    color:grey;\r\n`\r\n\r\nconst Component=observer(()=>{\r\n    const { ImageStore, UserStore }=useStores()\r\n    const ref1=useRef()  // 根据标记取到input中上传的宽/高\r\n    const ref2=useRef()\r\n    const bindWidthChange=()=>{  // change时,调用该函数\r\n        store.setWidth(ref1.current.value)  // 给setWidth()传入宽\r\n    }\r\n    const bindHeightChange=()=>{\r\n        store.setHeight(ref2.current.value)  // 给setHeight()传入高\r\n    }\r\n    const store=useLocalStore(()=>({  // 返回的是对象,所以要括号\r\n        // 宽部分\r\n        width:null,\r\n        setWidth(width){  // 拿到宽,处理成url字段\r\n            store.width=width\r\n        },\r\n        get widthStr(){\r\n            return store.width ? `/w/${store.width}` : ''\r\n        },\r\n\r\n        // 高部分\r\n        height:null,\r\n        setHeight(height){  // 拿到高,处理成url字段\r\n            store.height=height\r\n        },\r\n        get heightStr(){\r\n            return store.height ? `/h/${store.height}` : ''\r\n        },\r\n        // 图片地址后面 + 宽高的字段就是  变尺寸后的图片的url\r\n        get fullStr(){\r\n            return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\r\n        }\r\n    }))\r\n    const props = {\r\n        showUploadList:false,\r\n        beforeUpload:(file)=>{\r\n            ImageStore.setFile(file)  // 上传文件\r\n            ImageStore.setFilename(file.name)  // 上传文件名\r\n            if(UserStore.currentUser===null){\r\n                message.warning('请先登录再上传')\r\n                return false\r\n            }\r\n\r\n            window.file=file\r\n            // 格式判断: 如果不是以这些后缀结尾(忽略大小写)\r\n            if(!/(svg$)|(png$)|(jpeg$)|(gif$)/ig.test(file.type)){\r\n                message.error('只能上传png/svg/jpg/GIF格式的图片')\r\n                return false\r\n            }\r\n            // 大小判断:\r\n            if(file.size > 1024*1024){\r\n                message.error('只能上传小于1M的图片')\r\n                return false\r\n            }\r\n\r\n            ImageStore.upload()\r\n                .then((serverFile)=>{\r\n                    console.log('上传成功')\r\n                    console.log(serverFile)\r\n                }).catch(()=>{\r\n                    console.log('上传失败')\r\n                })\r\n            return false\r\n        }\r\n    }    \r\n    return(\r\n        <div>\r\n            {/* spin:正在加载 的组件  tip:文字 */}\r\n            <spin tip=\"loading...\" spinning={ImageStore.isUploading}>\r\n            <Dragger {...props}>\r\n                <p className=\"ant-upload-drag-icon\">\r\n                    <InboxOutlined />\r\n                </p>\r\n                <p className=\"ant-upload-text\">\r\n                    点击此处或者拖拽到此处上传图片\r\n                </p>\r\n                <p className=\"ant-upload-hint\">\r\n                    仅支持.png/.gif/.jpg/.svg格式的图片,图片不能超过1M \r\n                </p>\r\n            </Dragger>\r\n            </spin>\r\n            {\r\n                ImageStore.serverFile ? <Result>\r\n                    <H1>上传结果</H1>\r\n                    <dl>\r\n                        <H2>线上地址:</H2>\r\n                        <dd>\r\n                            <a target=\"_blank\" herf={ImageStore.serverFile.attributes.url.attributes.url}>{ImageStore.serverFile.attributes.url.attributes.url}</a>\r\n                        </dd>\r\n                        <H2>文件名:</H2>\r\n                        <dd>{ImageStore.filename}</dd>\r\n                        <H2>图片预览:</H2>\r\n                        <dd>\r\n                            <Image src={ImageStore.serverFile.attributes.url.attributes.url}/>\r\n                        </dd>\r\n                        <H2>更多尺寸:</H2>\r\n                        <dd>\r\n                            <input ref={ref1} onChange={bindWidthChange} placeholder='最大宽度(可选)'/>\r\n                            <input ref={ref2} onChange={bindHeightChange} placeholder='最大高度(可选)'/>\r\n                        </dd>\r\n                        <dd>\r\n                            {/* 展示上面得到的fullStr */}\r\n                            <a target=\"_blank\" herf={store.fullStr}>{store.fullStr}</a>\r\n                        </dd>\r\n                    </dl>\r\n                </Result> : null\r\n            }\r\n        </div>\r\n    )\r\n})\r\n\r\nexport default Component","import React from 'react'\r\nimport { useStores } from '../stores'\r\nimport { observer } from 'mobx-react'\r\nimport styled from 'styled-components'\r\n\r\nconst Tips=styled.div`\r\n    background:orange;\r\n    padding:10px;\r\n    margin:30px 0;\r\n    color:#fff;\r\n    border-radius:4px;\r\n`\r\n\r\nconst Component=observer(({children})=>{\r\n    const {UserStore}=useStores()\r\n    return (\r\n        <>\r\n            {\r\n                UserStore.currentUser ? null: <Tips>{children}</Tips>\r\n            }\r\n        </>\r\n    )\r\n})\r\n\r\nexport default Component","import React from 'react'\r\nimport { observer } from 'mobx-react'  // 监控当前store\r\nimport Uploader from '../components/Uploader'\r\nimport Tips from '../components/Tips'\r\n\r\nconst Home=observer(()=>{\r\n    return (\r\n        <>\r\n            <Tips>请先登录再上传</Tips>\r\n            <Uploader/>\r\n        </>\r\n    )\r\n})\r\n\r\nexport default Home"],"names":["Dragger","Upload","Result","styled","H1","Image","H2","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","setWidth","widthStr","height","setHeight","heightStr","fullStr","serverFile","attributes","url","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","window","test","type","size","upload","then","console","log","catch","tip","spinning","isUploading","className","InboxOutlined","target","herf","filename","src","ref","onChange","current","value","placeholder","Tips","children","Uploader"],"sourceRoot":""}